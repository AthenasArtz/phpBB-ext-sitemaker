!function(e,t,n,i){"use strict";function r(e){var t=a.getDoc(),n=t.getCursor(),i=t.getLine(n.line),r={line:n.line};i.match(/\S/i)?t.replaceRange("\n"+e,r):t.replaceRange(e,r)}var a={};e(n).ready(function(){var i=t.ajaxUrl||"",o=t.menuId||0,l=t.lang||{},u={},s={},c={},d="";(t.Twig||{}).extendFunction("lang",function(e){return void 0!==l[e]?l[e]:e}),e(n).ajaxSend(function(e,t,n){n.url+=n.url.indexOf("?")>=0?"&":"?",n.url+="menu_id="+o}),e(".items-list").iconPicker({selector:".icon-select",onSelect:function(e,t){var n=e.parentsUntil("li").parent().attr("id").substring(5);s.treeBuilder("updateItem",{item_icon:t},n)}});var m=e("#sm-menus").on("click",".menu-option",function(t){o=+e(this).parent().attr("id").substring(5),e(this).parent().parent().children().removeClass("row3 current-menu"),e(this).parent().addClass("row3 current-menu"),s.treeBuilder("getItems"),t.preventDefault()}).on("click",".menu-edit",function(t){var n=e(this).parent().prev().removeClass("menu-option").parent().removeClass("current-menu").find(".menu-editable");d=n.text(),p.show().appendTo(n.text("")).children(":input").val(d).focus().select().end(),t.preventDefault()}).on("click",".menu-delete",function(e){c.dialog({buttons:u}).dialog("open"),e.preventDefault()}),p=e('<form id="inline-menu-form"><input type="text" id="inline-menu-edit" value="" /></form>').hide().appendTo(e("body"));s=e("#nested-tree").treeBuilder({ajaxUrl:i,editForm:"#edit-menu-item-form",dialogEdit:"#dialog-edit-menu-item",dialogConfirm:"#dialog-confirm-menu-item"}),e(".toggle-view").click(function(t){e(e(this).attr("href")).slideToggle(),t.preventDefault()}),e("#add-menu").button().click(function(t){o=0,e.getJSON(i+"add_menu",function(e){if(null!==e.id){var t='<li id="menu-'+(o=e.id)+'" class="row3 current-menu">';t+='<a href="#" class="menu-option"><span class="menu-editable">'+e.title+"</span></a>",t+='<div class="menu-actions">',t+='<a href="#" class="menu-edit left" title="'+l.edit+'"><span class="ui-icon ui-icon-gear"></span></a>',t+='<a href="#" class="menu-delete left" title="'+l.remove+'"><span class="ui-icon ui-icon-trash"></span></a>',t+="</span></li>",m.children("li").removeClass("row3 current-menu"),m.append(t),s.show().treeBuilder("getItems")}}),t.preventDefault()}),e("#inline-menu-form").submit(function(t){t.preventDefault(),e(this).children("#inline-menu-edit").trigger("blur")}),e("#inline-menu-edit").focusout(function(t){var n=e(this).val(),r=e(this).val("").parent().parent();o&&n&&n!==d?e.post(i+"edit_menu",{title:n},function(e){e.name&&r.text(e.name)}):n=d,p.hide().appendTo(e("body")),r.text(n).parent().addClass("menu-option").parent().addClass("current-menu"),t.preventDefault()}),u[l.remove]=function(){o&&e.getJSON(i+"delete_menu",function(n){if(n.id===o){var i=e("#menu-"+o),r=i.prev(),a=i.next();r.length?r.find(".menu-option").trigger("click"):a.length?a.find(".menu-option").trigger("click"):t.location.reload(!1),i.remove()}}),e(this).dialog("close")},u[l.cancel]=function(){e(this).dialog("close")},c=e("#dialog-confirm-menu").dialog({autoOpen:!1,modal:!0,width:"auto",show:"slide",hide:"slide"}),o&&s.show(),a=e("#nested-tree").treeBuilder("getCodeMirrorInstance"),e(".bulk-type").button().click(function(t){t.preventDefault(),r(e(this).data("items").trim())}).each(function(t,n){var i=[],r=e(this).data("items").trim().split("\n");e.each(r,function(e,t){var n=t.split("|");i.push('<a href="#" data-item="'+t+'">'+n[0].replace(/\t/g,"&nbsp; &nbsp;")+"</a>")}),e(n).siblings(".bulk-dropdown").children(".inner").html(i.join("<br />"))});var f=e(".bulk-type-items").on("click","a",function(t){t.preventDefault(),r(e(this).data("item").trim()),e(this).parents(".bulk-type-items").toggle()});e(".bulk-type-list").button({text:!1,icons:{primary:"ui-icon-triangle-1-n"}}).click(function(t){t.preventDefault(),f.hide();var n=e(t.currentTarget),i=n.next(),r=n.offset(),a=i.height(),o=i.width();i.toggle().offset({top:r.top-a,left:r.left-o/2-n.width()})}).parent().buttonset();var g=0;a.on("keyup",function(e){var t=e.getDoc().getLine(e.getCursor().line).match(/\s/gim);g=t?t.length:0}),a.on("change",function(e,t){var n=g*e.options.tabSize;e.operation(function(){for(var i=t.from.line+1,r=CodeMirror.changeEnd(t).line;i<=r;++i)e.indentLine(i,n)})})})}(jQuery,window,document);
//# sourceMappingURL=admin.min.js.map
