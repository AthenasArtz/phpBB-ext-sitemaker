{"version":3,"sources":["blocks/manager.min.js"],"names":["$","window","document","undefined","editorVal","inactiveBlockClass","editing","updated","dialogEditOpened","blockPositions","emptyPositionsObj","template","origin","inlineForm","dialogConfirm","dialogEdit","dialogCopy","cButtons","dButtons","eButtons","lButtons","blockObj","blockData","editable","block","body","msgObj","saveBtn","lang","config","editMode","phpbb","tinymce","Twig","fixPaths","subject","replace","RegExp","match","g1","webRootPath","removeGrid","items","removeClass","matches","this","className","join","sortHorizontal","numItems","length","numCols","parent","data","itemsLeft","divisibleItems","hasClass","i","slice","addClass","n","showAllPositions","siblings","hideEmptyPositions","each","last","makeEditable","element","text","show","appendTo","children","val","focus","select","end","trigger","undoEditable","v","hide","renderBlock","id","editor","get","EditorManager","remove","content","html","render","name","find","execCommand","indexOf","eval","saveLayout","blocks","weight","pos","attr","bid","substring","position","post","ajaxUrl","route","button","addBlock","posID","blockName","droppedElement","removeAttr","ajaxLoading","trim","index","ext","getJSON","result","not","percent","getEditForm","resp","form","tabs","$this","change","toggleSelectSettings","dialog","buttons","edit","title","getCustomClasses","saveForm","updateSimilar","similar","class","encodeURI","serialize","list","row","updateBlock","customBlockAction","rawHTML","setContent","placeholder","setDefaultLayout","set","setStartPage","info","param","setRoutePrefs","exPositions","hidePositions","copyBlocks","copyFrom","empty","append","processInput","e","parentsUntil","field","previewBlock","extend","formData","serializeArray","cssClass","value","undoPreviewBlock","initTinyMce","init","selector","inline","image_advtab","hidden_input","plugins","toolbar","valid_elements","end_container_on_empty_block","setup","blockIsInactive","blockRawHTML","on","getContent","blockId","rawEditorContent","format","editorContent","showMessage","message","fadeIn","delay","fadeOut","positions","showCurrentState","hidingBlocks","hidingPos","ready","boardUrl","style","blocksPanel","overPosition","isHidingBlocks","loader","click","toggleClass","prev","toggle","twig","draggable","addClasses","iframeFix","opacity","helper","revert","connectToSortable","start","event","ui","sortable","stop","setTimeout","sortableOptions","connectWith","cancel","tolerance","cursor","cursorAt","top","left","item","over","out","isEmptyObject","update","stopPropagation","preventDefault","editorId","blur","next","disabled","exPos","styleSelector","ajaxSetup","beforeSend","xhr","settings","url","SID","complete","responseJSON","error","ajaxError","horizontalPos","defDialog","autoOpen","modal","width","deleteAll","dialogDeleteAll","copy","fromRoute","fromStyle","layoutAction","location","href","open","pane","prependTo","beforeClose","action","slideToggle","obj","animate","scrollTop","setDefault","controller","method","params","submit","is","onbeforeunload","returnValue","leaveConfirm","iconPicker","onSelect","iconClass","icon","jQuery"],"mappings":"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","file":"manager.min.js","sourcesContent":[";(function($, window, document, undefined) {\n\t'use strict';\n\n\tvar editorVal = '';\n\tvar inactiveBlockClass = 'sm-inactive';\n\tvar editing = false;\n\tvar updated = false;\n\tvar dialogEditOpened = false;\n\tvar blockPositions = {};\n\tvar emptyPositionsObj = {};\n\tvar template = {};\n\tvar origin = {};\n\tvar inlineForm = {};\n\tvar dialogConfirm = {};\n\tvar dialogEdit = {};\n\tvar dialogCopy = {};\n\tvar cButtons = {};\n\tvar dButtons = {};\n\tvar eButtons = {};\n\tvar lButtons = {};\n\tvar blockObj = {};\n\tvar blockData = {\n\t\teditable: ' editable',\n\t\tblock: {}\n\t};\n\tvar body = {};\n\tvar msgObj = {};\n\tvar saveBtn = {};\n\n\t// These variables are defined in template file\n\tvar lang = {};\n\tvar config = {};\n\tvar editMode = false;\n\n\t// These objects are provided by third-party scripts\n\tvar phpbb = {};\n\tvar tinymce = {};\n\tvar Twig = {};\n\n\tvar fixPaths = function(subject) {\n\t\treturn subject.replace(new RegExp('(?:href|src)=(?:\"|\\')((?:.\\/)?(?:\\.\\.\\/)+)(?:.*?)(?:\"|\\')', 'gmi'), function(match, g1) {\n\t\t\treturn match.replace(g1, config.webRootPath);\n\t\t});\n\t};\n\n\tvar removeGrid = function(items) {\n\t\titems.removeClass(function() {\n\t\t\tvar matches = this.className.match(/grid__col+(\\S+)?/gi);\n\t\t\treturn (matches) ? matches.join(' ') : '';\n\t\t});\n\t};\n\n\tvar sortHorizontal = function(items) {\n\t\tvar numItems = items.length;\n\t\tvar numCols = (items.parent().data('columns') !== undefined) ? ((items.parent().data('columns') <= 5) ? items.parent().data('columns') : 5) : 3;\n\t\tvar itemsLeft = numItems % numCols;\n\t\tvar divisibleItems = numItems - itemsLeft;\n\n\t\tif (numItems <= numCols) {\n\t\t\tnumCols = numItems;\n\t\t} else if (items.parent().hasClass('equal')) {\n\t\t\tif (itemsLeft > 0 && numCols > 3) {\n\t\t\t\tfor (var i = 1; i < itemsLeft; i++) {\n\t\t\t\t\tif (numItems % (numCols - i) === 0) {\n\t\t\t\t\t\tnumCols = numCols - i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tdivisibleItems = numItems;\n\t\t\titemsLeft = 0;\n\t\t}\n\n\t\tremoveGrid(items);\n\n\t\tif (divisibleItems > 0) {\n\t\t\titems.slice(0, divisibleItems).addClass('grid__col grid__col--1-of-' + numCols + ' grid__col--m-1-of-' + numCols);\n\t\t}\n\n\t\tif (itemsLeft) {\n\t\t\tvar n = 1;\n\t\t\tif (itemsLeft < 2) {\n\t\t\t\tn = 5;\n\t\t\t\titemsLeft = 5;\n\t\t\t}\n\t\t\titems.slice(divisibleItems, numItems)\n\t\t\t\t.addClass('grid__col grid__col--' + n + '-of-' + itemsLeft + ' grid__col--m-' + n + '-of-' + itemsLeft);\n\t\t}\n\t};\n\n\tvar showAllPositions = function() {\n\t\tblockPositions.addClass('show-position');\n\t\temptyPositionsObj.removeClass('empty-position').siblings('.grid__col').removeClass('lastUnit');\n\t};\n\n\tvar hideEmptyPositions = function() {\n\t\tblockPositions.removeClass('show-position');\n\t\temptyPositionsObj = $('.block-position:not(:has(\".block\"))').addClass('empty-position').each(function() {\n\t\t\t$(this).siblings('.grid__col').last().addClass('lastUnit');\n\t\t});\n\t};\n\n\tvar makeEditable = function(element) {\n\t\tif (editing === true) {\n\t\t\tinlineForm.children(':input').trigger('blur');\n\t\t\treturn;\n\t\t}\n\t\tediting = true;\n\t\teditorVal = element.removeClass('editable').text();\n\t\tinlineForm.show().appendTo(element.text('')).children(':input').val(editorVal).focus().select().end();\n\t};\n\n\tvar undoEditable = function(v) {\n\t\tvar element = inlineForm.parent();\n\n\t\tediting = false;\n\t\teditorVal = '';\n\t\telement.addClass('editable').text(v);\n\t\tinlineForm.hide().appendTo($('body'));\n\t};\n\n\tvar renderBlock = function(blockObj, blockData) {\n\t\t// if tinymce editor instance already exists, remove it\n\t\tvar id = 'block-editor-' + blockData.block.id;\n\t\tvar editor = tinymce.get(id);\n\t\tif (editor) {\n\t\t\ttinymce.EditorManager.remove(editor);\n\t\t}\n\n\t\tblockData.block.content = fixPaths(blockData.block.content);\n\n\t\t// Event to allow other extensions to manange how block is rendered\n\t\t// setting $('body').data('renderBlock', false) will prevent a render here\n\t\tif (body.trigger('renderBlock', [blockData.block, blockObj]).data('renderBlock') !== false) {\n\t\t\tblockObj.html(template.render(blockData));\n\t\t}\n\n\t\t// if custom block, add editor\n\t\tif (blockData.block.name === \"blitze.sitemaker.block.custom\") {\n\t\t\tif (blockObj.find('#' + id).length) {\n\t\t\t\ttinymce.EditorManager.execCommand('mceAddEditor', false, id);\n\t\t\t} else if (blockData.data.content.indexOf('script') > -1) {\n\t\t\t\teval(blockObj.find('.sm-block-content').html());\n\t\t\t}\n\t\t}\n\t};\n\n\tvar saveLayout = function() {\n\t\tvar blocks = {};\n\t\t$('.block-position').each(function() {\n\t\t\tvar weight = 0;\n\t\t\tvar pos = $(this).attr('id');\n\t\t\t$(this).find('.block').each(function() {\n\t\t\t\tvar id = $(this).attr('id');\n\t\t\t\tif (pos !== undefined && id !== undefined) {\n\t\t\t\t\tvar bid = id.substring(6);\n\t\t\t\t\tblocks[bid] = {\n\t\t\t\t\t\t'position': pos.substring(4),\n\t\t\t\t\t\t'weight': weight\n\t\t\t\t\t};\n\t\t\t\t\tweight++;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t$.post(config.ajaxUrl + '/blocks/save_blocks', {route: config.route, blocks: blocks}, function() {\n\t\t\tsaveBtn.button('disable');\n\t\t\tupdated = false;\n\t\t});\n\t};\n\n\tvar addBlock = function(posID, blockName, droppedElement) {\n\t\t$(droppedElement).removeAttr('role aria-disabled data-block class style')\n\t\t\t.addClass('block')\n\t\t\t.html('<div class=\"ui-state-highlight sm-block-spacing sortable\" style=\"padding: 5px\"><i class=\"fa fa-spinner fa-2x fa-spin\"></i> ' + lang.ajaxLoading + '</div>');\n\n\t\tvar data = {\n\t\t\tblock: $.trim(blockName),\n\t\t\tweight: droppedElement.parent().find('.block').index(droppedElement),\n\t\t\troute: config.route,\n\t\t\text: config.ext,\n\t\t\tposition: posID\n\t\t};\n\n\t\t$.getJSON(config.ajaxUrl + '/blocks/add_block', data, function(result) {\n\t\t\tupdated = false;\n\t\t\tif (result.id === '') {\n\t\t\t\t$(droppedElement).remove();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar blockObj = $(droppedElement).attr('id', 'block-' + result.id);\n\n\t\t\trenderBlock(blockObj, { block: result });\n\n\t\t\tblockObj.children().not('.block-controls')\n\t\t\t\t.show('scale', {percent: 100}, 1000);\n\n\t\t\tif (updated) {\n\t\t\t\tsaveLayout();\n\t\t\t}\n\t\t});\n\t};\n\n\tvar getEditForm = function(block) {\n\t\t$.getJSON(config.ajaxUrl + '/blocks/edit_block', {id: block.attr('id').substring(6)}, function(resp) {\n\t\t\tblockData.block = resp;\n\t\t\tif (resp.form) {\n\t\t\t\tdialogEdit.html(resp.form);\n\t\t\t\tdialogEdit.find('#block-settings').tabs();\n\t\t\t\tdialogEdit.find('select[data-togglable-settings]').each(function() {\n\t\t\t\t\tvar $this = $(this);\n\n\t\t\t\t\t$this.change(function() {\n\t\t\t\t\t\tphpbb.toggleSelectSettings($this);\n\t\t\t\t\t});\n\t\t\t\t\tphpbb.toggleSelectSettings($this);\n\t\t\t\t});\n\t\t\t\tdialogEdit.dialog({buttons: eButtons}).dialog('option', 'title', lang.edit + ' - ' + resp.title).dialog('open');\n\t\t\t}\n\t\t});\n\t};\n\n\tvar getCustomClasses = function() {\n\t\treturn dialogEdit.find('#block_class').text().trim();\n\t};\n\n\tvar saveForm = function(block) {\n\t\tvar form = $('#edit_form');\n\t\tvar updateSimilar = dialogEdit.dialog('widget').find('#update-similar:checked').length;\n\t\tvar data = {\n\t\t\t'id': block.attr('id').substring(6),\n\t\t\t'route': config.route,\n\t\t\t'similar': updateSimilar,\n\t\t\t'class': getCustomClasses()\n\t\t};\n\n\t\tif (data['config[source]']) {\n\t\t\tdata['config[source]'] = encodeURI(data['config[source]']);\n\t\t}\n\n\t\tdialogEdit.dialog('close');\n\n\t\t$.post(config.ajaxUrl + '/blocks/save_block?' + form.serialize(), data, function(resp) {\n\t\t\tif (resp.list) {\n\t\t\t\t$.each(resp.list, function(i, row) {\n\t\t\t\t\trenderBlock($('#block-' + row.id), { block: row });\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\n\tvar updateBlock = function(data) {\n\t\tif (data.id === undefined) {\n\t\t\treturn false;\n\t\t}\n\t\t$.post(config.ajaxUrl + '/blocks/update_block' + '?route=' + config.route, data, function(resp) {\n\t\t\tif (editing === true) {\n\t\t\t\tundoEditable(resp.title);\n\t\t\t}\n\t\t}, 'json');\n\t};\n\n\tvar customBlockAction = function(data) {\n\t\tif (data.id === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\t$.post(config.ajaxUrl + '/blocks/handle_custom_action', data, function(resp) {\n\t\t\tif (resp.id) {\n\t\t\t\tvar id = 'block-editor-' + resp.id;\n\t\t\t\tvar rawHTML = fixPaths(resp.content);\n\t\t\t\tvar block = $('#block-' + resp.id + ' > .sm-block-container');\n\t\t\t\tvar editor = $('#' + id).attr('data-raw', rawHTML);\n\n\t\t\t\ttinymce.get(id).setContent(rawHTML ? rawHTML : lang.placeholder);\n\n\t\t\t\tif (!resp.content || !editor.data('active')) {\n\t\t\t\t\tblock.addClass(inactiveBlockClass);\n\t\t\t\t} else  {\n\t\t\t\t\tblock.removeClass(inactiveBlockClass);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\tvar setDefaultLayout = function(set) {\n\t\t$.post(config.ajaxUrl + '/blocks/set_default_route' + '?route=' + ((set === true) ? config.route : ''));\n\t};\n\n\tvar setStartPage = function(info) {\n\t\t$.post(config.ajaxUrl + '/blocks/set_startpage', $.param(info));\n\t};\n\n\tvar setRoutePrefs = function(form, exPositions) {\n\t\t$.post(config.ajaxUrl + '/blocks/set_route_prefs' + '?route=' + config.route + '&ext=' + config.ext, form.serialize(), function() {\n\t\t\tblockPositions.removeClass(inactiveBlockClass);\n\t\t\tif (exPositions) {\n\t\t\t\thidePositions(exPositions);\n\t\t\t}\n\t\t});\n\t};\n\n\tvar copyBlocks = function(copyFrom) {\n\t\tvar position = $('.block-position');\n\t\t$.getJSON(config.ajaxUrl + '/blocks/copy_route?route=' + config.route + '&ext=' + config.ext + '&' + $.param(copyFrom), function(resp) {\n\t\t\tif (resp.list.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tshowAllPositions();\n\t\t\tposition.empty();\n\n\t\t\t$.each(resp.list, function(position, blocks) {\n\t\t\t\tvar pos = $('#pos-' + position);\n\t\t\t\t$.each(blocks, function(i, row) {\n\t\t\t\t\tblockData.block = row;\n\t\t\t\t\tpos.append('<div id=\"block-' + row.id + '\" class=\"unit size1of1 block\"></div>');\n\t\t\t\t\trenderBlock(pos.find('#block-' + row.id), blockData);\n\t\t\t\t});\n\n\t\t\t\tif (pos.hasClass('horizontal')) {\n\t\t\t\t\tsortHorizontal(pos.find('.block'));\n\t\t\t\t}\n\t\t\t});\n\t\t\thideEmptyPositions();\n\t\t});\n\t};\n\n\tvar processInput = function(e) {\n\t\tif (editing === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar id = $(e).parentsUntil('.block').parent().attr('id').substring(6);\n\t\tvar title = $(e).val();\n\n\t\tif (id && title !== editorVal) {\n\t\t\tupdateBlock({'id': id, 'field': 'title', 'title': title});\n\t\t} else {\n\t\t\tundoEditable(editorVal);\n\t\t}\n\t\treturn false;\n\t};\n\n\tvar previewBlock = function() {\n\t\t// make a copy of block data\n\t\tvar data = $.extend(true, {}, blockData);\n\t\tvar formData = dialogEdit.find('#edit_form').serializeArray();\n\t\tvar cssClass = getCustomClasses();\n\n\t\t$.each(formData, function() {\n\t\t\tdata.block[this.name] = (typeof data.block[this.name] === 'boolean') ? ((this.value === '1') ? true : false) : this.value;\n\t\t});\n\n\t\tdata.block['class'] = (cssClass) ? ' ' + cssClass : '';\n\n\t\trenderBlock(blockObj, data);\n\t};\n\n\tvar undoPreviewBlock = function() {\n\t\trenderBlock(blockObj, blockData);\n\t};\n\n\tvar initTinyMce = function() {\n\t\ttinymce.init({\n\t\t\t'selector': 'div.editable-block',\n\t\t\t'inline': true,\n\t\t\t'image_advtab': true,\n\t\t\t'hidden_input': false,\n\t\t\t'plugins': [\n\t\t\t\t'advlist autolink lists link image charmap preview hr anchor pagebreak',\n\t\t\t\t'visualblocks visualchars code',\n\t\t\t\t'media nonbreaking save table contextmenu directionality',\n\t\t\t\t'paste textcolor colorpicker textpattern'\n\t\t\t],\n\t\t\t'toolbar': [\n\t\t\t\t'undo redo | styleselect | bold italic | forecolor backcolor | alignleft aligncenter alignright alignjustify',\n\t\t\t\t'bullist numlist outdent indent | hr pagebreak | image media | link | table | preview code'\n\t\t\t],\n\t\t\t'valid_elements': '*[*]',\n\t\t\t'end_container_on_empty_block': true,\n\t\t\t'setup': function(editor) {\n\t\t\t\tvar blockObj = {};\n\t\t\t\tvar blockIsInactive = true;\n\t\t\t\tvar blockRawHTML = '';\n\n\t\t\t\teditor.on('init', function() {\n\t\t\t\t\tif (editor.getContent().length === 0) {\n\t\t\t\t\t\teditor.setContent(lang.placeholder);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\teditor.on('focus', function() {\n\t\t\t\t\tvar blockId = editor.id.substring(13);\n\t\t\t\t\tblockObj = $('#block-' + blockId + ' > .sm-block-container');\n\t\t\t\t\tblockIsInactive = blockObj.hasClass(inactiveBlockClass);\n\t\t\t\t\tblockRawHTML = $('#' + editor.id).data('raw');\n\t\t\t\t\teditor.setContent(blockRawHTML);\n\t\t\t\t});\n\n\t\t\t\teditor.on('keyUp', function() {\n\t\t\t\t\tif (blockIsInactive && editor.getContent().length) {\n\t\t\t\t\t\tblockIsInactive = false;\n\t\t\t\t\t\tblockObj.removeClass(inactiveBlockClass);\n\t\t\t\t\t} else if (!blockIsInactive && !editor.getContent().length) {\n\t\t\t\t\t\tblockIsInactive = true;\n\t\t\t\t\t\tblockObj.addClass(inactiveBlockClass);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\teditor.on('blur', function() {\n\t\t\t\t\tvar rawEditorContent = editor.getContent({format: 'raw'}).replace('<p><br data-mce-bogus=\"1\"></p>', '');\n\t\t\t\t\tvar editorContent = editor.getContent();\n\n\t\t\t\t\tif (rawEditorContent !== blockRawHTML && rawEditorContent !== lang.placeholder) {\n\t\t\t\t\t\tif (!editorContent.length) {\n\t\t\t\t\t\t\trawEditorContent = '';\n\t\t\t\t\t\t\teditor.setContent(lang.placeholder);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar blockData = $('#' + editor.id).data('raw', rawEditorContent).data();\n\t\t\t\t\t\tblockData.id = editor.id.substring(13);\n\t\t\t\t\t\tblockData.content = rawEditorContent;\n\n\t\t\t\t\t\tcustomBlockAction(blockData);\n\t\t\t\t\t} else if (!editorContent) {\n\t\t\t\t\t\teditor.setContent(lang.placeholder);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\n\tvar showMessage = function(message) {\n\t\tif (message) {\n\t\t\tmsgObj.html(message);\n\t\t\tmsgObj.fadeIn().delay(3000).fadeOut();\n\t\t}\n\t};\n\n\tvar hidePositions = function(positions) {\n\t\t$.each(positions, function(i, name) {\n\t\t\t$('#pos-' + name).addClass(inactiveBlockClass);\n\t\t});\n\t};\n\n\tvar showCurrentState = function(hidingBlocks, positions) {\n\t\tif (hidingBlocks) {\n\t\t\tshowMessage('<span><i class=\"fa fa-info-circle fa-blue fa-lg\"></i> ' + lang.hidingBlocks + '</span>');\n\t\t} else if (positions.length) {\n\t\t\tshowMessage('<span><i class=\"fa fa-info-circle fa-blue fa-lg\"></i> ' + lang.hidingPos + ': <strong>' + positions.join(', ') + '</strong></span>');\n\t\t\thidePositions(positions);\n\t\t}\n\t};\n\n\t$(document).ready(function() {\n\t\teditMode = window.editMode || false;\n\t\tlang = window.lang || {};\n\t\tphpbb = window.phpbb || {};\n\t\ttinymce = window.tinymce || {};\n\t\tTwig = window.Twig || {};\n\t\tconfig = window.config || {\n\t\t\tajaxUrl: '',\n\t\t\tboardUrl: '',\n\t\t\troute: '',\n\t\t\text: '',\n\t\t\tstyle: ''\n\t\t};\n\n\t\tvar copyFrom = '';\n\t\tvar blocksPanel = {};\n\t\tvar exPositions = {};\n\t\tvar overPosition = {};\n\t\tvar isHidingBlocks = false;\n\n\t\tvar loader = $('#admin-bar').show().find('#admin-control').click(function() {\n\t\t\tif (editMode) {\n\t\t\t\t$(this).toggleClass('admin-bar-toggler').prev().toggle();\n\t\t\t\tbody.toggleClass('push-down');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}).find('i');\n\n\t\tif (editMode) {\n\t\t\tinlineForm = $('<form class=\"inline-form\"><input type=\"text\" class=\"inline-edit\" value=\"\" /></form>').hide().appendTo($('body'));\n\n\t\t\tmsgObj = $('#ajax-message');\n\t\t\temptyPositionsObj = $('.block-position:not(:has(\".block\"))').addClass('empty-position');\n\n\t\t\ttemplate = Twig.twig({\n\t\t\t\tdata: $.trim($('#block-template-container').html())\n\t\t\t});\n\n\t\t\t$('#add-block-panel').find('.sitemaker-block').draggable({\n\t\t\t\taddClasses: false,\n\t\t\t\tiframeFix: true,\n\t\t\t\topacity: 0.7,\n\t\t\t\thelper: 'clone',\n\t\t\t\tappendTo: 'body',\n\t\t\t\trevert: 'invalid',\n\t\t\t\tconnectToSortable: '.block-position',\n\t\t\t\tstart: function(event, ui) {\n\t\t\t\t\t$(ui.helper).addClass('dragging');\n\t\t\t\t\tshowAllPositions();\n\t\t\t\t\tblockPositions.sortable('refresh');\n\t\t\t\t\tblocksPanel.trigger('click');\n\t\t\t\t},\n\t\t\t\tstop: function() {\n\t\t\t\t\twindow.setTimeout(function() {\n\t\t\t\t\t\tif (updated === false) {\n\t\t\t\t\t\t\thideEmptyPositions();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 600);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\texPositions = $('#ex_positions');\n\t\t\tvar sortableOptions = {\n\t\t\t\trevert: true,\n\t\t\t\tplaceholder: 'ui-state-highlight grid__col sm-block-spacing block sortable placeholder',\n\t\t\t\tconnectWith: '.block-position',\n\t\t\t\tcancel: '.editable-block, .inline-edit',\n\t\t\t\titems: '.block',\n\t\t\t\ttolerance: 'pointer',\n\t\t\t\tcursor: 'move',\n\t\t\t\tcursorAt: {\n\t\t\t\t\ttop: -10,\n\t\t\t\t\tleft: -10\n\t\t\t\t},\n\t\t\t\tstart: function(event, ui) {\n\t\t\t\t\torigin = $(ui.item).addClass('dragging').parent('.horizontal');\n\t\t\t\t\tshowAllPositions();\n\t\t\t\t\t$('.block-position').sortable('refresh');\n\t\t\t\t},\n\t\t\t\tover: function(event, ui) {\n\t\t\t\t\toverPosition = ui.placeholder.parent('.horizontal').children('.block').addClass('sortable');\n\t\t\t\t},\n\t\t\t\tout: function() {\n\t\t\t\t\tif ($.isEmptyObject(overPosition) === false) {\n\t\t\t\t\t\toverPosition.removeClass('sortable');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tupdate: function(event, ui) {\n\t\t\t\t\tupdated = true;\n\t\t\t\t\tif ($(ui.item).attr('id') === undefined) {\n\t\t\t\t\t\tvar posID = $(this).attr('id').substring(4);\n\t\t\t\t\t\tvar blockName = $(ui.item).attr('data-block');\n\t\t\t\t\t\tvar replace = $(this).find('div[data-block=\"' + blockName + '\"]');\n\t\t\t\t\t\taddBlock(posID, blockName, replace);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsaveBtn.button('enable');\n\t\t\t\t\t}\n\n\t\t\t\t\tvar items = $(ui.item).removeAttr('style').parent('.horizontal').children('.block');\n\t\t\t\t\tvar item = $(ui.item);\n\n\t\t\t\t\titem.parent().removeClass('empty-position');\n\t\t\t\t\tremoveGrid(item);\n\n\t\t\t\t\tif (items.length > 0) {\n\t\t\t\t\t\tsortHorizontal(items);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (origin.attr('id') !== $(ui.item).parent('.horizontal').attr('id')) {\n\t\t\t\t\t\tsortHorizontal(origin.find('.block').removeClass('sortable'));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tstop: function(event, ui) {\n\t\t\t\t\t$(ui.item).removeClass('dragging sortable').removeAttr('style');\n\t\t\t\t\thideEmptyPositions();\n\t\t\t\t\t$('body').trigger('layoutChanged');\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tblockPositions = $('.block-position').addClass('block-receiver').sortable(sortableOptions).on('click', '.block-title', function(e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\tmakeEditable($(this));\n\t\t\t}).on('submit', '.inline-form', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\t$(this).find('.inline-edit').trigger('blur');\n\t\t\t}).on('focusout', '.inline-edit', function() {\n\t\t\t\tprocessInput($(this));\n\t\t\t}).on('click', '.edit-block', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tblockObj = $(this).parentsUntil('.block').parent();\n\t\t\t\tgetEditForm(blockObj);\n\t\t\t}).on('click', '.delete-block', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tblockObj = $(this).parentsUntil('.block').parent();\n\t\t\t\tdialogConfirm.dialog({buttons: dButtons}).dialog('open');\n\t\t\t}).on('click', '.editable-block', function() {\n\t\t\t\tvar editorId = $(this).attr('id');\n\t\t\t\tif (!tinymce.get(editorId)) {\n\t\t\t\t\ttinymce.EditorManager.execCommand('mceAddEditor', false, editorId);\n\t\t\t\t\t$(this).blur();\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\ttinymce.get(editorId).focus();\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\t\t\t}).each(function() {\n\t\t\t\tvar pos = $(this).attr('id').substring(4);\n\t\t\t\tif (exPositions.find('option[value=' + pos + ']').length === 0) {\n\t\t\t\t\texPositions.append('<option value=\"' + pos + '\">' + pos + '</option>');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$('body').on('positionsChanged', function() {\n\t\t\t\tblockPositions = $('.block-position').addClass('block-receiver').sortable(sortableOptions);\n\t\t\t});\n\n\t\t\tsaveBtn = $('#toggle-edit').button().click(function() {\n\t\t\t\t// exit edit mode\n\t\t\t}).parent().next().children('a').button({disabled: true}).click(function(e) {\n\t\t\t\t// save changes\n\t\t\t\te.preventDefault();\n\t\t\t\tsaveLayout();\n\t\t\t});\n\n\t\t\t$('.has-dropdown').click(function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\t$(this).parentsUntil('ul').parent().find('.dropped').not($(this)).removeClass('dropped').next().hide();\n\t\t\t\tblocksPanel = $(this).toggleClass('dropped');\n\t\t\t\tblocksPanel.next().toggle();\n\t\t\t});\n\n\t\t\t$('#admin-options').show(100, function() {\n\t\t\t\tvar exPos = exPositions.val();\n\t\t\t\tif (exPos) {\n\t\t\t\t\tshowCurrentState(isHidingBlocks, exPos);\n\t\t\t\t}\n\n\t\t\t\t// Thanks KungFuJosh, for this tip\n\t\t\t\tbody = $('body').addClass('push-down');\n\t\t\t});\n\n\t\t\t// Only show style selector if there are other styles\n\t\t\tvar styleSelector = $('#style-options');\n\t\t\tif (styleSelector.find('option').length > 1) {\n\t\t\t\tstyleSelector.show();\n\t\t\t}\n\n\t\t\t$.ajaxSetup({\n\t\t\t\t// add style and session ids to ajax requests\n\t\t\t\t'beforeSend': function(xhr, settings) {\n\t\t\t\t\tloader.addClass('fa-spinner fa-green fa-spin fa-lg fa-pulse');\n\t\t\t\t\tsettings.url += ((settings.url.indexOf('?') < 0) ? '?' : '&') + 'style=' + config.style;\n\t\t\t\t\tsettings.url += (window.SID) ? '&sid=' + window.SID : '';\n\t\t\t\t},\n\t\t\t\t'complete': function(data) {\n\t\t\t\t\tloader.delay(2000).removeClass('fa-spinner fa-green fa-spin fa-lg fa-pulse');\n\n\t\t\t\t\tif (data.responseJSON) {\n\t\t\t\t\t\t// Display any returned message\n\t\t\t\t\t\tif (data.responseJSON.message) {\n\t\t\t\t\t\t\tshowMessage(data.responseJSON.message);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'error': function(event) {\n\t\t\t\t\tshowMessage((event.responseJSON && event.responseJSON.message) ? event.responseJSON.message : lang.ajaxError);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\teButtons[lang.edit] = function() {\n\t\t\t\tsaveForm(blockObj);\n\t\t\t};\n\n\t\t\teButtons[lang.cancel] = function() {\n\t\t\t\t$(this).dialog('close');\n\t\t\t};\n\n\t\t\tdButtons[lang.remove] = function() {\n\t\t\t\tvar horizontalPos = blockObj.parent('.horizontal');\n\n\t\t\t\tblockObj.remove();\n\t\t\t\thorizontalPos.find('.ui-effects-placeholder').remove();\n\n\t\t\t\tvar items = horizontalPos.find('.block');\n\n\t\t\t\tif (items.length > 0) {\n\t\t\t\t\tsortHorizontal(items);\n\t\t\t\t}\n\n\t\t\t\thideEmptyPositions();\n\t\t\t\tsaveBtn.button('enable');\n\t\t\t\t$(this).dialog('close');\n\t\t\t};\n\n\t\t\tdButtons[lang.cancel] = function() {\n\t\t\t\t$(this).dialog('close');\n\t\t\t};\n\n\t\t\tvar defDialog = {\n\t\t\t\tautoOpen: false,\n\t\t\t\tmodal: true,\n\t\t\t\twidth: 'auto',\n\t\t\t\tshow: 'slide',\n\t\t\t\thide: 'slide'\n\t\t\t};\n\n\t\t\tdialogConfirm = $('#dialog-confirm').dialog(defDialog);\n\n\t\t\t// Delete all blocks\n\t\t\tlButtons[lang.deleteAll] = function() {\n\t\t\t\t$(this).dialog('close');\n\t\t\t\t$('.block-position').empty();\n\t\t\t\thideEmptyPositions();\n\t\t\t\tsaveBtn.button('enable');\n\t\t\t\tupdated = true;\n\t\t\t};\n\n\t\t\tlButtons[lang.cancel] = function() {\n\t\t\t\t$(this).dialog('close');\n\t\t\t};\n\n\t\t\tvar dialogDeleteAll = $('#dialog-delete-all').dialog(defDialog);\n\t\t\tvar deleteAll = $('#delete-blocks').button().click(function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tdialogDeleteAll.dialog({buttons: lButtons}).dialog('open');\n\t\t\t});\n\n\t\t\t// Initiate dialog for block copy\n\t\t\tcButtons[lang.copy] = function() {\n\t\t\t\t$(this).dialog('close');\n\t\t\t\tcopyBlocks(copyFrom);\n\t\t\t\tdeleteAll.parent().show();\n\t\t\t};\n\n\t\t\tcButtons[lang.cancel] = function() {\n\t\t\t\t$(this).dialog('close');\n\t\t\t};\n\n\t\t\t// Events for add block dropdown\n\t\t\tdialogCopy = $('#dialog-copy').dialog(defDialog);\n\t\t\t$('#copy-form').find('.layout-action').button().click(function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tcopyFrom = $(this).parent().parent().serializeArray();\n\n\t\t\t\tvar fromRoute = copyFrom[0].value;\n\t\t\t\tvar fromStyle = copyFrom[1].value;\n\t\t\t\tvar layoutAction = $(this).data('action');\n\n\t\t\t\tif (fromRoute === '' || (fromRoute ===  config.route && fromStyle === config.style)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (layoutAction === 'copy') {\n\t\t\t\t\tblocksPanel.trigger('click');\n\t\t\t\t\tdialogCopy.dialog({buttons: cButtons}).dialog('open');\n\t\t\t\t} else {\n\t\t\t\t\tvar url = '';\n\n\t\t\t\t\turl += ((fromRoute.substring(0, 1) === '/') ? config.ajaxUrl : config.boardUrl + '/') + fromRoute;\n\t\t\t\t\turl += ((url.indexOf('?') >= 0) ? '&' : '?') + 'style=' + fromStyle + '&edit_mode=1';\n\n\t\t\t\t\twindow.location.href = url;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Events for edit block dialog\n\t\t\tdefDialog.open = function() {\n\t\t\t\tif (dialogEditOpened === false) {\n\t\t\t\t\tvar pane = $(this).dialog('widget').find('.ui-dialog-buttonpane');\n\t\t\t\t\tdialogEditOpened = true;\n\t\t\t\t\t$('<label class=\"dialog-check-button\"><input id=\"update-similar\" type=\"checkbox\" /> ' + lang.updateSimilar + '</label>').prependTo(pane);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tdefDialog.beforeClose = function() {\n\t\t\t\tundoPreviewBlock();\n\t\t\t};\n\n\t\t\tdialogEdit = $('#dialog-edit').dialog(defDialog).on('click', '.block-class-actions', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tvar action = $(this).data('action');\n\t\t\t\tvar editor = dialogEdit.find('#block_class');\n\t\t\t\tswitch (action) {\n\t\t\t\t\tcase 'clear':\n\t\t\t\t\t\teditor.text('').change();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'toggle':\n\t\t\t\t\t\tdialogEdit.find('#css-class-options').slideToggle();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'undo':\n\t\t\t\t\tcase 'redo':\n\t\t\t\t\t\teditor.focus();\n\t\t\t\t\t\tdocument.execCommand(action, false, null);\n\t\t\t\t\t\teditor.change();\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}).on('click', '.class-cat', function(e) {\n\t\t\t\tvar id = $(this).attr('href');\n\t\t\t\tvar obj = $('#classes-scroller');\n\t\t\t\tobj.animate({\n\t\t\t\t\tscrollTop: obj.scrollTop() + $(id).position().top\n\t\t\t\t}, 1000);\n\t\t\t\te.preventDefault();\n\t\t\t}).on('click', '.transform', function(e) {\n\t\t\t\tvar editor = dialogEdit.find('#block_class');\n\t\t\t\teditor.focus();\n\t\t\t\tdocument.execCommand('insertText', false, $(this).text() + ' ');\n\t\t\t\teditor.change();\n\t\t\t\te.preventDefault();\n\t\t\t}).on('change', '.block-preview', function() {\n\t\t\t\tpreviewBlock();\n\t\t\t});\n\n\t\t\t// Set default layout\n\t\t\t$('.default-layout').button().click(function(e) {\n\t\t\t\tvar setDefault = $(this).data('set');\n\t\t\t\tsetDefaultLayout(setDefault);\n\t\t\t\te.preventDefault();\n\t\t\t\tif (setDefault === true) {\n\t\t\t\t\t// set as default\n\t\t\t\t\t$(this).parent().hide().next().hide().next().show();\n\t\t\t\t\tdeleteAll.parent().hide();\n\t\t\t\t} else {\n\t\t\t\t\t// remove as default\n\t\t\t\t\t$(this).parent().hide().prev().hide().prev().show();\n\t\t\t\t\tdeleteAll.parent().show();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Set start page\n\t\t\t$('.sm-startpage').button().click(function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tvar info = {};\n\t\t\t\tif ($(this).attr('id') === 'set-startpage') {\n\t\t\t\t\t// set as startpage\n\t\t\t\t\t$(this).parent().hide().next().show();\n\t\t\t\t\tinfo = {\n\t\t\t\t\t\tcontroller: $(this).data('controller'),\n\t\t\t\t\t\tmethod: $(this).data('method'),\n\t\t\t\t\t\tparams: $(this).data('params')\n\t\t\t\t\t};\n\t\t\t\t\tsetStartPage(info);\n\t\t\t\t} else {\n\t\t\t\t\t// remove as startpage\n\t\t\t\t\t$(this).parent().hide().prev().show();\n\t\t\t\t\tsetStartPage(info);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tisHidingBlocks = $('#route-settings').submit(function(e) {\n\t\t\t\tsetRoutePrefs($(this), exPositions.val());\n\t\t\t\te.preventDefault();\n\t\t\t}).find('#hide_blocks').is(':checked');\n\n\t\t\twindow.onbeforeunload = function(e) {\n\t\t\t\tif (updated === true) {\n\t\t\t\t\te = e || window.event;\n\t\t\t\t\t// For IE and Firefox\n\t\t\t\t\tif (e) {\n\t\t\t\t\t\te.returnValue = lang.leaveConfirm;\n\t\t\t\t\t}\n\t\t\t\t\t// For Safari\n\t\t\t\t\treturn lang.leaveConfirm;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Init Icon Picker\n\t\t\t$('.sitemaker').iconPicker({\n\t\t\t\tselector: '.block-icon',\n\t\t\t\tonSelect: function(item, iconClass) {\n\t\t\t\t\tvar id = item.parentsUntil('.block').parent().attr('id').substring(6);\n\t\t\t\t\tupdateBlock({'id': id, 'icon': iconClass});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tinitTinyMce();\n\t\t}\n\t});\n})(jQuery, window, document);"]}